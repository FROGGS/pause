# $HeadURL$
# $Id$

### Define your hostname as a shell variable
# % HOSTNAME=your.host.name

### Every host must have done something like this:
# % openssl genrsa -out /etc/csync2_ssl_key.pem 2048
# % yes '' | openssl req -new -key /etc/csync2_ssl_key.pem -out /etc/csync2_ssl_cert.csr
# % openssl x509 -req -days 600 -in /etc/csync2_ssl_cert.csr -signkey \
#       /etc/csync2_ssl_key.pem -out /etc/csync2_ssl_cert.pem

### How to produce the symmetric key file:
# % mkdir -p /etc/csync2
# % perl -le 'print "perl"x8' >| /etc/csync2/pause_perl_org.key

### The following command shall add PAUSE to local DB, nothing more
# % csync2 -v -T /home/ftp/pub/PAUSE/authors/02STAMP -N $HOSTNAME

### Fallback if PAUSE does not respond to the above command (normally
### it has no csync2 daemon running):
# % /usr/bin/perl -le '
# use DBI; my $db = shift or die;
# my $dbh = DBI->connect("dbi:SQLite2:dbname=$db","","") or die;
# $dbh->do(q{delete from x509_cert where peername="pause.perl.org"});
# my $certdata = "30820306308201EE020900EE92CB3B54804EFA300D06092A864886F70D010104".
# "05003045310B3009060355040613024155311330110603550408130A536F6D652D5374617465312".
# "1301F060355040A1318496E7465726E6574205769646769747320507479204C7464301E170D3036".
# "303431393032303732395A170D3036303432303032303732395A3045310B3009060355040613024".
# "155311330110603550408130A536F6D652D53746174653121301F060355040A1318496E7465726E".
# "6574205769646769747320507479204C746430820122300D06092A864886F70D010101050003820".
# "10F003082010A0282010100CA202ABA0F2E7091F9A22439551E7DA910BF085B8F8055C2761768E0".
# "0445E0A582A2CBDFD130F6F1BCF69AC914063CC0B263E47644C7BCBF1E4644F9C2E48DABDB5A18A".
# "6777561C126FD5B4358383B71492C39BE87EE3E87E8889C9ECFA61DA23A12984C9984EBA63F6BC1".
# "A5F222CCE833A8201F6C12FD918A4DEA77D47D3FB2626B970909D7C4188974B3F03B505F52314DA".
# "88FC79FDC39C449BA7ADC7AA86B8ECA64801A26B0E750949D9A241DA3DB410E62E0B268A78BA276".
# "42F3CCB8C0C9392E66D722D1CBB4C835433A5D83B7095397CE05486ED6FB84726F755FDC9D90FB7".
# "E242AD3D461A3F439E0CBEC6DE209A70771BB3F539396F0B4011B4CF876690203010001300D0609".
# "2A864886F70D0101040500038201010030352E666E224D4A0BA1E427D52DE45A3D08531A3BC8154".
# "BC1A7D145935EDEC3276E8E7914A0F93C4D87B9290AF9CB7E8D96428AAF6D9638DACEA061EAFAC6".
# "65025CD531A32575E2BF8C76E9F7E46E641BC3BC15DEFCE613F36F11176DD0821A93F139B199EF1".
# "2EDBE7084C2682E31E27324C28322599D4980798AD81066BAD9466C1E47D776F2D951B768FC9B5F".
# "CF51957E7D9D2390E09816EBA7978B9E77F5C02C60E85B0C498076EBF940C957029E2AED444A6CA".
# "EA106CD5EAAFB2F88708792EBC856060A19A71F92046A11EB142BEE2F6AE8DECE92A2A9C49A7A74".
# "1EA4DB56912FD027093C40D3432C54489B1F563C2786AA315C1574760C2FA0DA986A9A";
# $dbh->do(qq{insert into x509_cert (peername, certdata) values ("pause.perl.org","$certdata")});
# my $sth = $dbh->prepare(q{select * from x509_cert where peername="pause.perl.org"});
# $sth->execute;
# while (my @row = $sth->fetchrow){
#   print "row[@row]";
# }' /var/lib/csync2/$HOSTNAME.db


### If your hostname(1) program does not print the hostname that PAUSE
### can use, add the '-N $HOSTNAME' option to your csync2 line in your
### inetd.conf file.

### Slave is ready to go now.

### How to call csync2 on the master (PAUSE does that itself):
# % csync2 -x -v -G pause_perl_org -N pause.perl.org

group pause_perl_org {
  host pause.perl.org;
  host (franz.ak.mind.de);
  host (pause2.fiz-chemie.de);

  key /etc/csync2/pause_perl_org.key;
  include /home/ftp/pub/PAUSE/authors;
  include /home/ftp/pub/PAUSE/modules;
  include /home/ftp/pub/PAUSE/scripts;
  auto left;
}
